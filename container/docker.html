<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | DevProj</title>
    <meta name="description" content="开发、学习文档集">
    <link rel="icon" href="/documents/hero.png">
    
    <link rel="preload" href="/documents/assets/css/0.styles.6c48564b.css" as="style"><link rel="preload" href="/documents/assets/js/app.233cd6b8.js" as="script"><link rel="preload" href="/documents/assets/js/2.522665e9.js" as="script"><link rel="preload" href="/documents/assets/js/8.eb4e3ddf.js" as="script"><link rel="prefetch" href="/documents/assets/js/10.02432e9b.js"><link rel="prefetch" href="/documents/assets/js/11.feee8bc7.js"><link rel="prefetch" href="/documents/assets/js/12.ca3593a3.js"><link rel="prefetch" href="/documents/assets/js/13.2df332ae.js"><link rel="prefetch" href="/documents/assets/js/14.227be58e.js"><link rel="prefetch" href="/documents/assets/js/15.50029f7e.js"><link rel="prefetch" href="/documents/assets/js/16.bf58ee74.js"><link rel="prefetch" href="/documents/assets/js/17.3a4c07ee.js"><link rel="prefetch" href="/documents/assets/js/18.123695f3.js"><link rel="prefetch" href="/documents/assets/js/3.47e1b649.js"><link rel="prefetch" href="/documents/assets/js/4.6ad2ae7d.js"><link rel="prefetch" href="/documents/assets/js/5.d34a31b0.js"><link rel="prefetch" href="/documents/assets/js/6.d7b6f6ca.js"><link rel="prefetch" href="/documents/assets/js/7.a511ab83.js"><link rel="prefetch" href="/documents/assets/js/9.87303d94.js">
    <link rel="stylesheet" href="/documents/assets/css/0.styles.6c48564b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documents/" class="home-link router-link-active"><!----> <span class="site-name">DevProj</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/documents/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="PHP" class="dropdown-title"><span class="title">PHP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>开发环境</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/documents/php/devenv/macos.html" class="nav-link">macOS</a></li><li class="dropdown-subitem"><a href="/documents/php/devenv/windows.html" class="nav-link">Windows</a></li></ul></li><li class="dropdown-item"><h4>开发框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/documents/php/framework/yii.html" class="nav-link">Yii</a></li><li class="dropdown-subitem"><a href="/documents/php/framework/laravel.html" class="nav-link">Laravel</a></li></ul></li><li class="dropdown-item"><h4>Swoole</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/documents/php/swoole/basic.html" class="nav-link">基础</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="container" class="dropdown-title"><span class="title">容器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documents/container/docker.html" class="nav-link router-link-exact-active router-link-active">Docker</a></li><li class="dropdown-item"><!----> <a href="/documents/container/docker_swarm.html" class="nav-link">Docker Swarm</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/documents/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="PHP" class="dropdown-title"><span class="title">PHP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>开发环境</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/documents/php/devenv/macos.html" class="nav-link">macOS</a></li><li class="dropdown-subitem"><a href="/documents/php/devenv/windows.html" class="nav-link">Windows</a></li></ul></li><li class="dropdown-item"><h4>开发框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/documents/php/framework/yii.html" class="nav-link">Yii</a></li><li class="dropdown-subitem"><a href="/documents/php/framework/laravel.html" class="nav-link">Laravel</a></li></ul></li><li class="dropdown-item"><h4>Swoole</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/documents/php/swoole/basic.html" class="nav-link">基础</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="container" class="dropdown-title"><span class="title">容器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documents/container/docker.html" class="nav-link router-link-exact-active router-link-active">Docker</a></li><li class="dropdown-item"><!----> <a href="/documents/container/docker_swarm.html" class="nav-link">Docker Swarm</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/documents/container/docker.html#基础篇" class="sidebar-link">基础篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documents/container/docker.html#基本概念" class="sidebar-link">基本概念</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#安装-docker" class="sidebar-link">安装 Docker</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#加速器" class="sidebar-link">加速器</a></li></ul></li><li><a href="/documents/container/docker.html#镜像篇" class="sidebar-link">镜像篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documents/container/docker.html#基本操作" class="sidebar-link">基本操作</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#理解-commit" class="sidebar-link">理解 Commit</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#镜像构建" class="sidebar-link">镜像构建</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#多阶段构建" class="sidebar-link">多阶段构建</a></li></ul></li><li><a href="/documents/container/docker.html#容器篇" class="sidebar-link">容器篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documents/container/docker.html#基本操作-2" class="sidebar-link">基本操作</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#进入容器" class="sidebar-link">进入容器</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#备份与还原" class="sidebar-link">备份与还原</a></li></ul></li><li><a href="/documents/container/docker.html#仓库篇" class="sidebar-link">仓库篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documents/container/docker.html#docker-hub" class="sidebar-link">Docker Hub</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#阿里云仓库" class="sidebar-link">阿里云仓库</a></li></ul></li><li><a href="/documents/container/docker.html#网络篇" class="sidebar-link">网络篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documents/container/docker.html#网络类型" class="sidebar-link">网络类型</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#容器互联" class="sidebar-link">容器互联</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#端口映射" class="sidebar-link">端口映射</a></li></ul></li><li><a href="/documents/container/docker.html#数据篇" class="sidebar-link">数据篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documents/container/docker.html#数据卷" class="sidebar-link">数据卷</a></li><li class="sidebar-sub-header"><a href="/documents/container/docker.html#映射目录" class="sidebar-link">映射目录</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h1> <h2 id="基础篇"><a href="#基础篇" class="header-anchor">#</a> 基础篇</h2> <h3 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h3> <h4 id="镜像"><a href="#镜像" class="header-anchor">#</a> 镜像</h4> <h4 id="容器"><a href="#容器" class="header-anchor">#</a> 容器</h4> <h4 id="仓库"><a href="#仓库" class="header-anchor">#</a> 仓库</h4> <h3 id="安装-docker"><a href="#安装-docker" class="header-anchor">#</a> 安装 Docker</h3> <h4 id="macos"><a href="#macos" class="header-anchor">#</a> macOS</h4> <p>Homebrew 的 Cask 已经支持 Docker Desktop for Mac：</p> <div class="language-shell script extra-class"><pre class="language-text"><code>$ brew cask install docker
</code></pre></div><h4 id="centos-7"><a href="#centos-7" class="header-anchor">#</a> CentOS 7</h4> <h5 id="卸载旧版本"><a href="#卸载旧版本" class="header-anchor">#</a> 卸载旧版本</h5> <div class="language-shell script extra-class"><pre class="language-text"><code>$ sudo yum remove docker \
    docker-client \
    docker-client-latest \
    docker-common \
    docker-latest \
    docker-latest-logrotate \
    docker-logrotate \
    docker-selinux \
    docker-engine-selinux \
    docker-engine
</code></pre></div><h5 id="使用-yum-安装"><a href="#使用-yum-安装" class="header-anchor">#</a> 使用 yum 安装</h5> <p>执行以下命令安装依赖包：</p> <div class="language-shell script extra-class"><pre class="language-text"><code>$ sudo yum install -y yum-utils \
    device-mapper-persistent-data \
    lvm2
</code></pre></div><p>执行下面的命令添加 yum 软件源：</p> <div class="language-shell script extra-class"><pre class="language-text"><code>$ sudo yum-config-manager \
    --add-repo \
    https://mirrors.ustc.edu.cn/docker-ce/linux/centos/docker-ce.repo
</code></pre></div><h5 id="安装-docker-ce"><a href="#安装-docker-ce" class="header-anchor">#</a> 安装 Docker CE</h5> <p>更新 <code>yum</code> 软件源缓存，并安装 <code>docker-ce</code>：</p> <div class="language-shell script extra-class"><pre class="language-text"><code>$ sudo yum makecache fast
$ sudo yum install docker-ce
</code></pre></div><h5 id="启动-docker-ce"><a href="#启动-docker-ce" class="header-anchor">#</a> 启动 Docker CE</h5> <div class="language-shell script extra-class"><pre class="language-text"><code>$ sudo systemctl enable docker
$ sudo systemctl start docker
</code></pre></div><h4 id="ubuntu-16-04"><a href="#ubuntu-16-04" class="header-anchor">#</a> Ubuntu 16.04</h4> <h5 id="卸载旧版本-2"><a href="#卸载旧版本-2" class="header-anchor">#</a> 卸载旧版本</h5> <div class="language-shell script extra-class"><pre class="language-text"><code>$ sudo apt-get remove docker \
    docker-engine \
    docker.io
</code></pre></div><h5 id="使用-apt-安装"><a href="#使用-apt-安装" class="header-anchor">#</a> 使用 apt 安装</h5> <p>由于 apt 源使用 HTTPS 以确保软件下载过程中不被篡改。因此，我们首先需要添加使用 HTTPS 传输的软件包以及 CA 证书。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update
$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token punctuation">\</span>
    apt-transport-https <span class="token punctuation">\</span>
    ca-certificates <span class="token punctuation">\</span>
    <span class="token function">curl</span> <span class="token punctuation">\</span>
    software-properties-common
</code></pre></div><p>为了确认所下载软件包的合法性，需要添加软件源的 GPG 密钥。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -
</code></pre></div><p>然后，我们需要向 source.list 中添加 Docker 软件源</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> add-apt-repository <span class="token punctuation">\</span>
    <span class="token string">&quot;deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \
    <span class="token variable"><span class="token variable">$(</span>lsb_release -cs<span class="token variable">)</span></span> \
    stable&quot;</span>
</code></pre></div><h5 id="安装-docker-ce-2"><a href="#安装-docker-ce-2" class="header-anchor">#</a> 安装 Docker CE</h5> <p>更新 apt 软件包缓存，并安装 docker-ce：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update
$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> docker-ce
</code></pre></div><h5 id="启动-docker-ce-2"><a href="#启动-docker-ce-2" class="header-anchor">#</a> 启动 Docker CE</h5> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> docker
$ <span class="token function">sudo</span> systemctl start docker
</code></pre></div><h3 id="加速器"><a href="#加速器" class="header-anchor">#</a> 加速器</h3> <p>Ubuntu 16.04+、CentOS 7</p> <p>对于使用 systemd 的系统，请在 <code>/etc/docker/daemon.json</code> 中写入如下内容（如果文件不存在请新建该文件）</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;https://dockerhub.azk8s.cn&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;https://reg-mirror.qiniu.com&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>之后重新启动服务。</p> <div class="language-shell script extra-class"><pre class="language-shell"><code>$ <span class="token function">sudo</span> systemctl daemon-reload
$ <span class="token function">sudo</span> systemctl restart docker
</code></pre></div><p>对于使用 macOS 的用户，在任务栏点击 Docker Desktop 应用图标 -&gt; Perferences... -&gt; Daemon -&gt; Registry mirrors。在列表中填写加速器地址 <code>https://dockerhub.azk8s.cn</code>。修改完成之后，点击 Apply &amp; Restart 按钮，Docker 就会重启并应用配置的镜像地址了。</p> <p>执行 <code>$ docker info</code>，如果从结果中看到了如下内容，说明配置成功。</p> <div class="language- extra-class"><pre class="language-text"><code>Registry Mirrors:
 https://dockerhub.azk8s.cn/
</code></pre></div><h2 id="镜像篇"><a href="#镜像篇" class="header-anchor">#</a> 镜像篇</h2> <h3 id="基本操作"><a href="#基本操作" class="header-anchor">#</a> 基本操作</h3> <h4 id="获取镜像"><a href="#获取镜像" class="header-anchor">#</a> 获取镜像</h4> <h4 id="列出镜像"><a href="#列出镜像" class="header-anchor">#</a> 列出镜像</h4> <h4 id="设置标签"><a href="#设置标签" class="header-anchor">#</a> 设置标签</h4> <h4 id="运行镜像"><a href="#运行镜像" class="header-anchor">#</a> 运行镜像</h4> <h4 id="虚悬镜像"><a href="#虚悬镜像" class="header-anchor">#</a> 虚悬镜像</h4> <h4 id="删除镜像"><a href="#删除镜像" class="header-anchor">#</a> 删除镜像</h4> <h3 id="理解-commit"><a href="#理解-commit" class="header-anchor">#</a> 理解 Commit</h3> <h3 id="镜像构建"><a href="#镜像构建" class="header-anchor">#</a> 镜像构建</h3> <h3 id="多阶段构建"><a href="#多阶段构建" class="header-anchor">#</a> 多阶段构建</h3> <h2 id="容器篇"><a href="#容器篇" class="header-anchor">#</a> 容器篇</h2> <h3 id="基本操作-2"><a href="#基本操作-2" class="header-anchor">#</a> 基本操作</h3> <h3 id="进入容器"><a href="#进入容器" class="header-anchor">#</a> 进入容器</h3> <h3 id="备份与还原"><a href="#备份与还原" class="header-anchor">#</a> 备份与还原</h3> <h2 id="仓库篇"><a href="#仓库篇" class="header-anchor">#</a> 仓库篇</h2> <h3 id="docker-hub"><a href="#docker-hub" class="header-anchor">#</a> Docker Hub</h3> <h3 id="阿里云仓库"><a href="#阿里云仓库" class="header-anchor">#</a> 阿里云仓库</h3> <h2 id="网络篇"><a href="#网络篇" class="header-anchor">#</a> 网络篇</h2> <h3 id="网络类型"><a href="#网络类型" class="header-anchor">#</a> 网络类型</h3> <h3 id="容器互联"><a href="#容器互联" class="header-anchor">#</a> 容器互联</h3> <h3 id="端口映射"><a href="#端口映射" class="header-anchor">#</a> 端口映射</h3> <h2 id="数据篇"><a href="#数据篇" class="header-anchor">#</a> 数据篇</h2> <h3 id="数据卷"><a href="#数据卷" class="header-anchor">#</a> 数据卷</h3> <h3 id="映射目录"><a href="#映射目录" class="header-anchor">#</a> 映射目录</h3></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">12/28/2019, 4:22:25 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/documents/assets/js/app.233cd6b8.js" defer></script><script src="/documents/assets/js/2.522665e9.js" defer></script><script src="/documents/assets/js/8.eb4e3ddf.js" defer></script>
  </body>
</html>
